<?xml version="1.0" encoding="UTF-8"?>

<!-- Version 07.30.2020.1-->
<!-- Parameter1 for ABAP SAP SID example ECP-->
<!-- HANA DB is automatically associated using DB in SAP App Properties-->

<itc:report xmlns:itc="urn:itconductor">
   <!-- Get SAP object and then set its object id to variable -->
   <itc:section>
      <itc:parameter name="className">SAP</itc:parameter>
      <itc:select name="SAP.SID">${self/REPORT.Param1}</itc:select>
      <itc:variable name="SAPObjectId">${context/OBJECT_Id}</itc:variable>
      <itc:variable name="SAPSID">${context/SAP.SID}</itc:variable>
      <itc:variable name="HANACluster">${name:context/SAP.DBMS}</itc:variable>
      <h1>${report/SAPSID}/${report/HANACluster} Service Health and Utilization Report</h1>
      <pbr />
      <!-- SAP Availability -->
      <h2>SAP System ${report/SAPSID} Availability</h2>
      <itc:threshold>
         <itc:parameter name="THRESHOLD_ObjectId">${report/SAPObjectId}</itc:parameter>
         <itc:parameter name="THRESHOLD_AttributeName">OBJECT_Availability</itc:parameter>
         <itc:parameter name="title">true</itc:parameter>
         <itc:parameter name="table">false</itc:parameter>
         <itc:parameter name="timeScale">HOUR</itc:parameter>
         <itc:parameter name="range">H12</itc:parameter>
         <itc:parameter name="fit">width</itc:parameter>
      </itc:threshold>
      <!-- SAP Performance Overview -->
      <h2>${report/SAPSID} SAP Performance Overview</h2>
      <itc:chart>
         <itc:parameter name="OBJECT_Id">23146379</itc:parameter>
         <itc:parameter name="context">${report/SAPObjectId}</itc:parameter>
         <itc:parameter name="timeScale">HOUR</itc:parameter>
         <itc:parameter name="range">H12</itc:parameter>
         <itc:parameter name="fit">width</itc:parameter>
         <itc:parameter name="legend">top</itc:parameter>
      </itc:chart>


         <h2>${report/SAPSID} CCMS Alerts Categories</h2>

	   <itc:chart>
		  <itc:parameter name="OBJECT_Id">8279134</itc:parameter>
		  <itc:parameter name="context">${report/SAPObjectId}</itc:parameter>
		  <itc:parameter name="table">false</itc:parameter>
		  <itc:parameter name="timeScale">HOUR</itc:parameter>
		  <itc:parameter name="range">H24</itc:parameter>
		  <itc:parameter name="fit">width</itc:parameter>
		  <itc:parameter name="legend">top</itc:parameter>
	   </itc:chart>

	   <itc:chart>
		  <itc:parameter name="OBJECT_Id">8279134</itc:parameter>
		  <itc:parameter name="context">${report/SAPObjectId}</itc:parameter>
		  <itc:parameter name="table">true</itc:parameter>
		  <itc:parameter name="timeScale">HOUR</itc:parameter>
		  <itc:parameter name="range">H24</itc:parameter>
		  <itc:parameter name="fit">width</itc:parameter>
		  <itc:parameter name="legend">top</itc:parameter>
	   </itc:chart>

      <!-- hanadb related sections in here -->
      <itc:section>
         <itc:parameter name="className">ClusterMember</itc:parameter>
         <itc:select name="LINK_ObjectId">${context/SAP.DBMS}</itc:select>
         <itc:parameter name="linkAttrName">LINK_LinkedObjectId</itc:parameter>
         <itc:parameter name="linkClassName">HANADb</itc:parameter>
         <itc:parameter name="sortAttr">APPLICATION_SiteName</itc:parameter>
         <itc:parameter name="sortOrder">ASC</itc:parameter>
         <itc:section>
            <itc:parameter name="className">HANADb</itc:parameter>
            <itc:select name="OBJECT_Id">${context/OBJECT_Id}</itc:select>
            <itc:select name="OBJECT_MaintenanceMode">false</itc:select>
            <itc:select name="APPLICATION_StandByMode">false</itc:select>
            <itc:variable name="HANAObjectId">${context/OBJECT_Id}</itc:variable>
            <itc:variable name="HANASID">${context/HANADb.SID}</itc:variable>
            <h2>${report/HANASID} ${name:context/APPLICATION_Site}</h2>
            <!-- HANA Availability -->
            <h3>HANA ${report/HANASID} Availability</h3>
            <itc:threshold>
               <itc:parameter name="THRESHOLD_ObjectId">${report/HANAObjectId}</itc:parameter>
               <itc:parameter name="THRESHOLD_AttributeName">OBJECT_Availability</itc:parameter>
               <itc:parameter name="title">true</itc:parameter>
               <itc:parameter name="table">false</itc:parameter>
               <itc:parameter name="timeScale">HOUR</itc:parameter>
               <itc:parameter name="range">H12</itc:parameter>
               <itc:parameter name="fit">width</itc:parameter>
            </itc:threshold>
            <!-- HANA Performance Overview -->
            <h2>${report/HANASID} HANA Performance Overview</h2>
            <itc:chart>
               <itc:parameter name="OBJECT_Id">6077053883419751</itc:parameter>
               <itc:parameter name="context">${report/HANAObjectId}</itc:parameter>
               <itc:parameter name="range">H12</itc:parameter>
               <itc:parameter name="fit">width</itc:parameter>
               <itc:parameter name="timeScale">HOUR</itc:parameter>
               <itc:parameter name="legend">top</itc:parameter>
            </itc:chart>

            <h2>HANA ${report/HANASID} Replication Backlog Time</h2>
            <itc:section>
               <itc:parameter name="className">HANAServiceReplication</itc:parameter>
               <!--<itc:select name="APPLICATION_SERVICE.ApplicationId">${report/HANAObjectId}</itc:select>-->
               <itc:select name="HANAComponentService.SystemID">${report/HANASID}</itc:select>
               <itc:select name="HANAServiceReplication.REPLICATION_STATUS">ACTIVE</itc:select>
               <h3>${context/OBJECT_Name}</h3>
               <itc:threshold>
                  <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
                  <itc:parameter name="THRESHOLD_AttributeName">HANAServiceReplication.BACKLOG_TIME</itc:parameter>
                  <itc:parameter name="title">true</itc:parameter>
                  <itc:parameter name="table">false</itc:parameter>
                  <itc:parameter name="timeScale">HOUR</itc:parameter>
                  <itc:parameter name="range">H12</itc:parameter>
                  <itc:parameter name="fit">width</itc:parameter>
               </itc:threshold>
            </itc:section>
            <h2>HANA ${report/HANASID} Volumes Used %</h2>
            <itc:section>
               <itc:parameter name="className">HANAVolumeFile</itc:parameter>
               <itc:select name="APPLICATION_SERVICE.ApplicationId">${report/HANAObjectId}</itc:select>
               <itc:select name="HANAVolumeFile.FILE_TYPE">DATA</itc:select>
               <h3>${context/OBJECT_Name}</h3>
               <itc:threshold>
                  <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
                  <itc:parameter name="THRESHOLD_AttributeName">HANAVolumeFile.USED_PERCENT</itc:parameter>
                  <itc:parameter name="title">true</itc:parameter>
                  <itc:parameter name="table">false</itc:parameter>
                  <itc:parameter name="timeScale">HOUR</itc:parameter>
                  <itc:parameter name="range">H12</itc:parameter>
                  <itc:parameter name="fit">width</itc:parameter>
               </itc:threshold>
            </itc:section>
            <!-- DB Server Linux Performance Overview -->
            <h2>DB Server Linux Performance Overview</h2>
            <itc:section>
               <itc:parameter name="className">HANAHost</itc:parameter>
               <itc:select name="APPLICATION_SERVICE.ApplicationId">${report/HANAObjectId}</itc:select>
               <itc:section>
                  <itc:parameter name="className">SSH2-Linux</itc:parameter>
                  <itc:select name="SSH2.EffectiveHost">${context/HANAHost.HOST}</itc:select>
                  <h3>${context/OBJECT_Name}</h3>
                  <itc:chart>
                     <itc:parameter name="OBJECT_Id">54508500</itc:parameter>
                     <itc:parameter name="context">${context/OBJECT_Id}</itc:parameter>
                     <itc:parameter name="title">true</itc:parameter>
                     <itc:parameter name="timeScale">HOUR</itc:parameter>
                     <itc:parameter name="range">H12</itc:parameter>
                     <itc:parameter name="fit">width</itc:parameter>
                  </itc:chart>
               </itc:section>
            </itc:section>
         </itc:section>
      </itc:section>
      <h2>Background Jobs Runtime (In-flight)</h2>
      <itc:alerts>
         <!-- Target Alerts Criteria -->
         <itc:parameter name="className">CCMSJobObjectAlert</itc:parameter>
         <itc:select name="ObjectAlert.ApplicationId">${report/SAPObjectId}</itc:select>
         <itc:select name="ALERT.Message" oper="MATCH">Long Running Job</itc:select>
         <itc:select name="ALERT.Time" oper="GT">${auto/timestamp&lt;1d}</itc:select>
         <itc:parameter name="table">true</itc:parameter>
         <itc:parameter name="width">100%</itc:parameter>
         <itc:parameter name="timeScale">HOUR</itc:parameter>
      </itc:alerts>
      <h2>${report/SAPSID} Alerts ALL</h2>
      <itc:section>
         <itc:parameter name="className">SAPCCMSAlertAggregator</itc:parameter>
         <itc:select name="SAPAggregator.ApplicationId ">${report/SAPObjectId}</itc:select>
         <itc:select name="OBJECT_Name">All</itc:select>
         <itc:threshold>
            <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
            <itc:parameter name="THRESHOLD_AttributeName">AGGREGATOR.Count</itc:parameter>
            <itc:parameter name="title">true</itc:parameter>
            <itc:parameter name="table">false</itc:parameter>
            <itc:parameter name="timeScale">HOUR</itc:parameter>
            <itc:parameter name="range">H12</itc:parameter>
            <itc:parameter name="fit">width</itc:parameter>
         </itc:threshold>
      </itc:section>
      <h2>${report/SAPSID} Failed Batch Jobs</h2>
      <itc:section>
         <itc:parameter name="className">SAPCCMSAlertAggregator</itc:parameter>
         <itc:select name="SAPAggregator.ApplicationId ">${report/SAPObjectId}</itc:select>
         <itc:select name="OBJECT_Name">Failed Batch Jobs</itc:select>
         <itc:threshold>
            <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
            <itc:parameter name="THRESHOLD_AttributeName">AGGREGATOR.Count</itc:parameter>
            <itc:parameter name="title">true</itc:parameter>
            <itc:parameter name="table">false</itc:parameter>
            <itc:parameter name="timeScale">HOUR</itc:parameter>
            <itc:parameter name="range">H12</itc:parameter>
            <itc:parameter name="fit">width</itc:parameter>
         </itc:threshold>
      </itc:section>
      <h2>${report/SAPSID} ST22 Shortdumps</h2>
      <itc:section>
         <itc:parameter name="className">SAPCCMSAlertAggregator</itc:parameter>
         <itc:select name="SAPAggregator.ApplicationId ">${report/SAPObjectId}</itc:select>
         <itc:select name="OBJECT_Name">Shortdumps</itc:select>
         <itc:threshold>
            <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
            <itc:parameter name="THRESHOLD_AttributeName">AGGREGATOR.Count</itc:parameter>
            <itc:parameter name="title">true</itc:parameter>
            <itc:parameter name="table">false</itc:parameter>
            <itc:parameter name="timeScale">HOUR</itc:parameter>
            <itc:parameter name="range">H12</itc:parameter>
            <itc:parameter name="fit">width</itc:parameter>
         </itc:threshold>
      </itc:section>
      <itc:section>
         <itc:parameter name="className">SAPqRFCInboundThresholdCollection</itc:parameter>
         <itc:select name="THRESHOLD_COLLECTION.ApplicationId">${report/SAPObjectId}</itc:select>
         <itc:select name="THRESHOLD_COLLECTION.ValueAttributeName">SAPRFCQueue.FAGE</itc:select>
         <h2>tRFC and qRFC Inbound Queue First Entry Age</h2>
         <itc:chart>
            <itc:parameter name="OBJECT_Id">${context/OBJECT_Id}</itc:parameter>
            <itc:parameter name="table">false</itc:parameter>
            <itc:parameter name="width1">100%</itc:parameter>
            <itc:parameter name="timeScale">HOUR</itc:parameter>
            <itc:parameter name="range">LD</itc:parameter>
            <itc:parameter name="valuesOnly">true</itc:parameter>
            <itc:parameter name="annotations">false</itc:parameter>
         </itc:chart>
      </itc:section>
      <itc:section>
         <itc:parameter name="className">SAPqRFCInboundThresholdCollection</itc:parameter>
         <itc:select name="THRESHOLD_COLLECTION.ApplicationId">${report/SAPObjectId}</itc:select>
         <itc:select name="THRESHOLD_COLLECTION.ValueAttributeName">SAPRFCQueue.QSTATE_NAME</itc:select>
         <h2>tRFC and qRFC Inbound Queue Queue State</h2>
         <itc:chart>
            <itc:parameter name="OBJECT_Id">${context/OBJECT_Id}</itc:parameter>
            <itc:parameter name="table">false</itc:parameter>
            <itc:parameter name="width1">100%</itc:parameter>
            <itc:parameter name="timeScale">HOUR</itc:parameter>
            <itc:parameter name="range">LD</itc:parameter>
            <itc:parameter name="valuesOnly">true</itc:parameter>
            <itc:parameter name="annotations">false</itc:parameter>
         </itc:chart>
      </itc:section>
      <itc:section>
         <itc:parameter name="className">SAPqRFCOutboundThresholdCollection</itc:parameter>
         <itc:select name="THRESHOLD_COLLECTION.ApplicationId">${report/SAPObjectId}</itc:select>
         <itc:select name="THRESHOLD_COLLECTION.ValueAttributeName">SAPRFCQueue.FAGE</itc:select>
         <h2>tRFC and qRFC OutBound Queue First Entry Age</h2>
         <itc:chart>
            <itc:parameter name="OBJECT_Id">${context/OBJECT_Id}</itc:parameter>
            <itc:parameter name="table">false</itc:parameter>
            <itc:parameter name="width1">100%</itc:parameter>
            <itc:parameter name="timeScale">HOUR</itc:parameter>
            <itc:parameter name="range">LD</itc:parameter>
            <itc:parameter name="valuesOnly">true</itc:parameter>
            <itc:parameter name="annotations">false</itc:parameter>
         </itc:chart>
      </itc:section>
      <itc:section>
         <itc:parameter name="className">SAPqRFCOutboundThresholdCollection</itc:parameter>
         <itc:select name="THRESHOLD_COLLECTION.ApplicationId">${report/SAPObjectId}</itc:select>
         <itc:select name="THRESHOLD_COLLECTION.ValueAttributeName">SAPRFCQueue.QSTATE_NAME</itc:select>
         <h2>tRFC and qRFC OutBound Queue Queue State</h2>
         <itc:chart>
            <itc:parameter name="OBJECT_Id">${context/OBJECT_Id}</itc:parameter>
            <itc:parameter name="table">false</itc:parameter>
            <itc:parameter name="width1">100%</itc:parameter>
            <itc:parameter name="timeScale">HOUR</itc:parameter>
            <itc:parameter name="range">LD</itc:parameter>
            <itc:parameter name="valuesOnly">true</itc:parameter>
            <itc:parameter name="annotations">false</itc:parameter>
         </itc:chart>
      </itc:section>
   </itc:section>
</itc:report>
