<?xml version="1.0" encoding="UTF-8"?>

<!-- Name :  ZP $[context/APPLICATION_Role] $[context/OBJECT_Name]/$[context/JMXP4.DBMS=>OBJECT_Name] Java Health KPI Daily Reports-->
<!-- Parameter1 : $[context/OBJECT_Id] -->
<!-- HANA DB is automatically associated using DB in SAP App Properties-->

<itc:report xmlns:itc="urn:itconductor">
   <!-- Get SAP object and then set its object id to variable -->
   <itc:section>
      <itc:parameter name="className">JMXP4</itc:parameter>
      <itc:select name="OBJECT_Id">${self/REPORT.Param1}</itc:select>
      <itc:variable name="JAVAObjectId">${context/OBJECT_Id}</itc:variable>
      <itc:variable name="JAVASID">${context/OBJECT_Name}</itc:variable>
      <itc:variable name="HANACluster">${context/JMXP4.DBMS=>OBJECT_Name}</itc:variable>
      <h1>Java ${report/JAVASID}/${report/HANACluster} Service Health and Utilization Report</h1>
      <pbr />
      <!-- SAP Availability -->
      <h2>SAP System Availability</h2>
      <itc:threshold>
         <itc:parameter name="THRESHOLD_ObjectId">${report/JAVAObjectId}</itc:parameter>
         <itc:parameter name="THRESHOLD_AttributeName">OBJECT_Availability</itc:parameter>
         <itc:parameter name="title">false</itc:parameter>
         <itc:parameter name="table">false</itc:parameter>
         <itc:parameter name="valuesOnly">true</itc:parameter>
         <itc:parameter name="annotations">false</itc:parameter>
         <itc:parameter name="fit">width</itc:parameter>
         <itc:parameter name="timeScale">HOUR</itc:parameter>
         <itc:parameter name="range">H12</itc:parameter>
      </itc:threshold>
      <!-- hanadb related sections in here -->
      <itc:section>
         <itc:parameter name="className">ClusterMember</itc:parameter>
         <itc:select name="LINK_ObjectId">${context/JMXP4.DBMS}</itc:select>
         <itc:parameter name="linkAttrName">LINK_LinkedObjectId</itc:parameter>
         <itc:parameter name="linkClassName">HANADb</itc:parameter>
         <itc:parameter name="sortAttr">APPLICATION_SiteName</itc:parameter>
         <itc:parameter name="sortOrder">ASC</itc:parameter>
         <itc:section>
            <itc:parameter name="className">HANADb</itc:parameter>
            <itc:select name="OBJECT_Id">${context/OBJECT_Id}</itc:select>
            <itc:select name="OBJECT_MaintenanceMode">false</itc:select>
            <itc:variable name="HANAObjectId">${context/OBJECT_Id}</itc:variable>
            <itc:variable name="HANASID">${context/HANADb.SID}</itc:variable>
            <h2>${report/HANASID} ${name:context/APPLICATION_Site}</h2>
            <!-- HANA Availability -->
            <h3>HANA ${report/HANASID} Availability</h3>
            <itc:threshold>
               <itc:parameter name="THRESHOLD_ObjectId">${report/HANAObjectId}</itc:parameter>
               <itc:parameter name="THRESHOLD_AttributeName">OBJECT_Availability</itc:parameter>
               <itc:parameter name="title">false</itc:parameter>
               <itc:parameter name="table">false</itc:parameter>
               <itc:parameter name="timeScale">HOUR</itc:parameter>
               <itc:parameter name="range">H12</itc:parameter>
               <itc:parameter name="fit">width</itc:parameter>
            </itc:threshold>
            <!-- HANA Service Performance Overview -->
            <h3>HANA Service Performance Overview</h3>
            <itc:chart>
               <itc:parameter name="OBJECT_Id">6077053883419751</itc:parameter>
               <itc:parameter name="context">${report/HANAObjectId}</itc:parameter>
               <itc:parameter name="title">false</itc:parameter>
               <itc:parameter name="timeScale">HOUR</itc:parameter>
               <itc:parameter name="range">H12</itc:parameter>
               <itc:parameter name="fit">width</itc:parameter>
               <itc:parameter name="legend">top</itc:parameter>
            </itc:chart>
            <h3>HANA ${report/HANASID} Replication Backlog Time</h3>
            <itc:section>
               <itc:parameter name="className">HANAServiceReplication</itc:parameter>
               <itc:select name="APPLICATION_SERVICE.ApplicationId">${report/HANAObjectId}</itc:select>
               <itc:select name="HANAServiceReplication.REPLICATION_STATUS">ACTIVE</itc:select>
               <h4>${context/OBJECT_Name}</h4>
               <itc:threshold>
                  <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
                  <itc:parameter name="THRESHOLD_AttributeName">HANAServiceReplication.BACKLOG_TIME</itc:parameter>
                  <itc:parameter name="title">false</itc:parameter>
                  <itc:parameter name="table">false</itc:parameter>
                  <itc:parameter name="timeScale">HOUR</itc:parameter>
                  <itc:parameter name="range">H12</itc:parameter>
                  <itc:parameter name="fit">width</itc:parameter>
               </itc:threshold>
            </itc:section>
            <h3>HANA Volumes Used %</h3>
            <itc:section>
               <itc:parameter name="className">HANAVolumeFile</itc:parameter>
               <itc:select name="APPLICATION_SERVICE.ApplicationId">${report/HANAObjectId}</itc:select>
               <h4>${context/OBJECT_Name}</h4>
               <itc:threshold>
                  <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
                  <itc:parameter name="THRESHOLD_AttributeName">HANAVolumeFile.USED_PERCENT</itc:parameter>
                  <itc:parameter name="title">true</itc:parameter>
                  <itc:parameter name="table">false</itc:parameter>
                  <itc:parameter name="timeScale">HOUR</itc:parameter>
                  <itc:parameter name="range">H12</itc:parameter>
                  <itc:parameter name="fit">width</itc:parameter>
               </itc:threshold>
            </itc:section>
            <!-- DB Server Linux Performance Overview -->
            <h3>DB Server Linux Performance Overview</h3>
            <itc:section>
               <itc:parameter name="className">HANAHost</itc:parameter>
               <itc:select name="APPLICATION_SERVICE.ApplicationId">${report/HANAObjectId}</itc:select>
               <itc:section>
                  <itc:parameter name="className">SSH2-Linux</itc:parameter>
                  <itc:select name="SSH2.EffectiveHost">${context/HANAHost.HOST}</itc:select>
                  <h4>${context/OBJECT_Name}</h4>
                  <itc:chart>
                     <itc:parameter name="OBJECT_Id">54508500</itc:parameter>
                     <itc:parameter name="context">${context/OBJECT_Id}</itc:parameter>
                     <itc:parameter name="title">true</itc:parameter>
                     <itc:parameter name="timeScale">HOUR</itc:parameter>
                     <itc:parameter name="range">H12</itc:parameter>
                     <itc:parameter name="fit">width</itc:parameter>
                  </itc:chart>
               </itc:section>
            </itc:section>
         </itc:section>
      </itc:section>
      <!-- SAP JAVA System CPU Utilization  -->
      <h2>SAP JAVA System CPU Utilization</h2>
      <itc:section>
         <itc:parameter name="className">SAPJ2EEClusterNode</itc:parameter>
         <itc:select name="APPLICATION_SERVICE.ApplicationId">${report/JAVAObjectId}</itc:select>
         <itc:variable name="clusterNode">${context/SAPJ2EEClusterNode.Name}</itc:variable>
         <itc:section>
            <itc:parameter name="className">SAPJMXMonitorMetric</itc:parameter>
            <itc:select name="SAPJMXMetric.ClusterNode">${context/SAPJ2EEClusterNode.ID}</itc:select>
            <itc:select name="SAPJMXMetric.MetricName">CPU Utilization</itc:select>
            <h3>${report/clusterNode} ${context/SAPJMXMetric.ObjectShortName}</h3>
            <itc:threshold>
               <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
               <itc:parameter name="THRESHOLD_AttributeName">SAPJMXMetric.MetricValue</itc:parameter>
               <itc:parameter name="title">false</itc:parameter>
               <itc:parameter name="table">false</itc:parameter>
               <itc:parameter name="timeScale">HOUR</itc:parameter>
               <itc:parameter name="range">H12</itc:parameter>
               <itc:parameter name="fit">width</itc:parameter>
            </itc:threshold>
         </itc:section>
      </itc:section>
      <!-- SAP JAVA System Memory Utilization  -->
      <h2>SAP JAVA System Memory Utilization</h2>
      <itc:section>
         <itc:parameter name="className">SAPJ2EEClusterNode</itc:parameter>
         <itc:select name="APPLICATION_SERVICE.ApplicationId">${report/JAVAObjectId}</itc:select>
         <itc:variable name="clusterNode">${context/SAPJ2EEClusterNode.Name}</itc:variable>
         <itc:section>
            <itc:parameter name="className">SAPJMXMonitorMetric</itc:parameter>
            <itc:select name="SAPJMXMetric.ClusterNode">${context/SAPJ2EEClusterNode.ID}</itc:select>
            <itc:select name="SAPJMXMetric.MetricName">Memory Utilization</itc:select>
            <h3>${report/clusterNode} ${context/SAPJMXMetric.ObjectShortName}</h3>
            <itc:threshold>
               <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
               <itc:parameter name="THRESHOLD_AttributeName">SAPJMXMetric.MetricValue</itc:parameter>
               <itc:parameter name="title">false</itc:parameter>
               <itc:parameter name="table">false</itc:parameter>
               <itc:parameter name="timeScale">HOUR</itc:parameter>
               <itc:parameter name="range">H12</itc:parameter>
               <itc:parameter name="fit">width</itc:parameter>
            </itc:threshold>
         </itc:section>
      </itc:section>
      <!-- System Free Disk Space Percent  -->
      <h2>System Free Disk Space Percent</h2>
      <itc:section>
         <itc:parameter name="className">SAPJ2EEClusterNode</itc:parameter>
         <itc:select name="APPLICATION_SERVICE.ApplicationId">${report/JAVAObjectId}</itc:select>
         <itc:variable name="clusterNode">${context/SAPJ2EEClusterNode.Name}</itc:variable>
         <itc:section>
            <itc:parameter name="className">SAPJMXMonitorMetric</itc:parameter>
            <itc:select name="SAPJMXMetric.ClusterNode">${context/SAPJ2EEClusterNode.ID}</itc:select>
            <itc:select name="SAPJMXMetric.MetricName">Free Disk Space</itc:select>
            <h3>${report/clusterNode} ${context/SAPJMXMetric.ObjectShortName}</h3>
            <itc:threshold>
               <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
               <itc:parameter name="THRESHOLD_AttributeName">SAPJMXMetric.MetricValue</itc:parameter>
               <itc:parameter name="title">false</itc:parameter>
               <itc:parameter name="table">false</itc:parameter>
               <itc:parameter name="timeScale">HOUR</itc:parameter>
               <itc:parameter name="range">H12</itc:parameter>
               <itc:parameter name="fit">width</itc:parameter>
            </itc:threshold>
         </itc:section>
      </itc:section>
      <!-- JVM GC Problems  -->
      <h2>JVM GC Problems</h2>
      <itc:section>
         <itc:parameter name="className">SAPJ2EEClusterNode</itc:parameter>
         <itc:select name="APPLICATION_SERVICE.ApplicationId">${report/JAVAObjectId}</itc:select>
         <itc:variable name="clusterNode">${context/SAPJ2EEClusterNode.Name}</itc:variable>
         <itc:section>
            <itc:parameter name="className">SAPJMXMonitorMetric</itc:parameter>
            <itc:select name="SAPJMXMetric.ClusterNode">${context/SAPJ2EEClusterNode.ID}</itc:select>
            <itc:select name="SAPJMXMetric.MetricName">GC Problems</itc:select>
            <h3>${report/clusterNode} ${context/SAPJMXMetric.ObjectShortName}</h3>
            <itc:threshold>
               <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
               <itc:parameter name="THRESHOLD_AttributeName">SAPJMXMetric.MetricValue</itc:parameter>
               <itc:parameter name="title">false</itc:parameter>
               <itc:parameter name="table">false</itc:parameter>
               <itc:parameter name="timeScale">HOUR</itc:parameter>
               <itc:parameter name="range">H12</itc:parameter>
               <itc:parameter name="fit">width</itc:parameter>
            </itc:threshold>
         </itc:section>
      </itc:section>
      <!-- JVM Out Of Memory Errors  -->
      <h2>JVM Out Of Memory Errors</h2>
      <itc:section>
         <itc:parameter name="className">SAPJ2EEClusterNode</itc:parameter>
         <itc:select name="APPLICATION_SERVICE.ApplicationId">${report/JAVAObjectId}</itc:select>
         <itc:variable name="clusterNode">${context/SAPJ2EEClusterNode.Name}</itc:variable>
         <itc:section>
            <itc:parameter name="className">SAPJMXMonitorMetric</itc:parameter>
            <itc:select name="SAPJMXMetric.ClusterNode">${context/SAPJ2EEClusterNode.ID}</itc:select>
            <itc:select name="SAPJMXMetric.MetricName">Out Of Memory Errors</itc:select>
            <h3>${report/clusterNode} ${context/SAPJMXMetric.ObjectShortName}</h3>
            <itc:threshold>
               <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
               <itc:parameter name="THRESHOLD_AttributeName">SAPJMXMetric.MetricValue</itc:parameter>
               <itc:parameter name="title">false</itc:parameter>
               <itc:parameter name="table">false</itc:parameter>
               <itc:parameter name="timeScale">HOUR</itc:parameter>
               <itc:parameter name="range">H12</itc:parameter>
               <itc:parameter name="fit">width</itc:parameter>
            </itc:threshold>
         </itc:section>
      </itc:section>
      <!-- JVM System Problems  -->
      <h2>JVM System Problems</h2>
      <itc:section>
         <itc:parameter name="className">SAPJ2EEClusterNode</itc:parameter>
         <itc:select name="APPLICATION_SERVICE.ApplicationId">${report/JAVAObjectId}</itc:select>
         <itc:variable name="clusterNode">${context/SAPJ2EEClusterNode.Name}</itc:variable>
         <itc:section>
            <itc:parameter name="className">SAPJMXMonitorMetric</itc:parameter>
            <itc:select name="SAPJMXMetric.ClusterNode">${context/SAPJ2EEClusterNode.ID}</itc:select>
            <itc:select name="SAPJMXMetric.MetricName">System Problems</itc:select>
            <h3>${report/clusterNode} ${context/SAPJMXMetric.ObjectShortName}</h3>
            <itc:threshold>
               <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
               <itc:parameter name="THRESHOLD_AttributeName">SAPJMXMetric.MetricValue</itc:parameter>
               <itc:parameter name="title">false</itc:parameter>
               <itc:parameter name="table">false</itc:parameter>
               <itc:parameter name="timeScale">HOUR</itc:parameter>
               <itc:parameter name="range">H12</itc:parameter>
               <itc:parameter name="fit">width</itc:parameter>
            </itc:threshold>
         </itc:section>
      </itc:section>
      <!-- SAP JAVA Server Average RFC Times  -->
      <h2>SAP JAVA Server Average RFC Times</h2>
      <itc:section>
         <itc:parameter name="className">SAPJ2EEClusterNode</itc:parameter>
         <itc:select name="APPLICATION_SERVICE.ApplicationId">${report/JAVAObjectId}</itc:select>
         <itc:variable name="clusterNode">${context/OBJECT_Name}</itc:variable>
         <itc:section>
            <itc:parameter name="className">SAPJMXMonitorMetric</itc:parameter>
            <itc:select name="SAPJMXMetric.ClusterNode">${context/SAPJ2EEClusterNode.ID}</itc:select>
            <itc:select name="SAPJMXMetric.MetricName">Average RFC Time</itc:select>
            <h3>${report/clusterNode} ${context/SAPJMXMetric.ObjectShortName}</h3>
            <itc:threshold>
               <itc:parameter name="THRESHOLD_ObjectId">${context/OBJECT_Id}</itc:parameter>
               <itc:parameter name="THRESHOLD_AttributeName">SAPJMXMetric.MetricValue</itc:parameter>
               <itc:parameter name="title">false</itc:parameter>
               <itc:parameter name="table">false</itc:parameter>
               <itc:parameter name="timeScale">HOUR</itc:parameter>
               <itc:parameter name="range">H12</itc:parameter>
               <itc:parameter name="fit">width</itc:parameter>
            </itc:threshold>
         </itc:section>
      </itc:section>
   </itc:section>
</itc:report>
